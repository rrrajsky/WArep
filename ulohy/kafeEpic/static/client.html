<!DOCTYPE html>
<html lang="cs">
<script>
        let socket;

        // Function to connect to WebSocket server
        function connectWebSocket() {
            socket = new WebSocket('ws://192.168.33.48:8081//');

            socket.onopen = function() {
                console.log('Connected to server');
            };

            socket.onmessage = function(event) {
                const data = JSON.parse(event.data);
                
                // Update coffee list
                const coffeeList = document.getElementById('coffeeList');
                coffeeList.innerHTML = ''; // Clear the list
                data.users.forEach(user => {
                    coffeeList.innerHTML += '<li class="coffeeItem">' + user.name + ' vypil ' + user.coffees + ' kávy (poslední: ' + user.lastCoffee + ')</li>';
                });

                // Update task list
                const taskList = document.getElementById('taskList');
                taskList.innerHTML = ''; // Clear the list
                data.tasks.forEach(task => {
                    taskList.innerHTML += '<li class="taskItem ' + (task.assignedTo ? (task.completed ? '' : 'highlight') : '') + '">' + task.task + ' - ' + (task.assignedTo || 'Nikomu') + '</li>';
                });
            };

            socket.onclose = function() {
                console.log('Connection closed');
            };

            socket.onerror = function(event) {
                console.error('Error: ' + JSON.stringify(event));
            };
        }

        // Automatically connect when page loads
        document.addEventListener('DOMContentLoaded', function() {
            connectWebSocket();
        });

        // Function to send coffee data
        document.getElementById('addCoffee').onclick = function() {
            const coffeeDetails = document.getElementById('coffeeDetails').value;
            if (socket && socket.readyState === WebSocket.OPEN) {
                socket.send(JSON.stringify({ action: 'add_coffee', details: coffeeDetails }));
                document.getElementById('coffeeDetails').value = ''; // Clear input field
            } else {
                alert('Connection is not open');
            }
        };

        // Function to send task data
        document.getElementById('addTask').onclick = function() {
            const taskDetails = document.getElementById('taskDetails').value;
            if (socket && socket.readyState === WebSocket.OPEN) {
                socket.send(JSON.stringify({ action: 'add_task', details: taskDetails }));
                document.getElementById('taskDetails').value = ''; // Clear input field
            } else {
                alert('Connection is not open');
            }
        };
    </script>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kávovar Dashboard</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            background-color: #f4f4f9;
        }

        #dashboard {
            width: 600px;
            height: 700px;
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 20px;
            background-color: #fff;
            margin-top: 20px;
            overflow-y: auto;
        }

        h1 {
            color: #333;
        }

        h2 {
            margin-top: 20px;
            color: #555;
        }

        #coffeeForm, #taskForm {
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            align-items: stretch;
        }

        input, button {
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
        }

        button {
            background-color: #007bff;
            color: white;
            cursor: pointer;
        }

        button:hover {
            background-color: #0056b3;
        }

        #coffeeList, #taskList {
            margin-top: 20px;
            padding: 0;
            list-style: none;
        }

        .taskItem, .coffeeItem {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 10px;
            background-color: #f9f9f9;
        }

        .highlight {
            background-color: #ffdddd;
        }
    </style>
</head>
<body>
    <h1>Kávovar Dashboard</h1>
    
    <div id="dashboard">
        <h2>Pøidat kávu</h2>
        <div id="coffeeForm">
            <input type="text" id="coffeeDetails" placeholder="Zadejte typ kávy">
            <button id="addCoffee">Pøidat kávu</button>
        </div>

        <h2>Pøidat úkol</h2>
        <div id="taskForm">
            <input type="text" id="taskDetails" placeholder="Zadejte úkol">
            <button id="addTask">Pøidat úkol</button>
        </div>

        <h2>Statistiky kávy</h2>
        <ul id="coffeeList"></ul>

        <h2>Seznam úkolù</h2>
        <ul id="taskList"></ul>
    </div>

    
</body>
</html>
